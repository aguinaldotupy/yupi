var A=Object.defineProperty;var h=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var M=(p,d,l)=>d in p?A(p,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):p[d]=l,k=(p,d)=>{for(var l in d||(d={}))J.call(d,l)&&M(p,l,d[l]);if(h)for(var l of h(d))K.call(d,l)&&M(p,l,d[l]);return p};import{e as B,r as L,c as y,w as R,z as m,A as z,B as H,C as s,K as u,u as e,P as D,L as F,M as N,J as U,a1 as j,j as x,O as Q,N as W}from"./vendor.8df7962f.js";import{j as X,l as ee,b as te,d as f,r as b,f as ae}from"./main.9bc4ee1d.js";const ne=["onSubmit"],le=["onSubmit"],de={setup(p){const d=X(),l=ee(),{t:g,tm:se}=te();let v=B(!1),$=B(!1),i=B(!1);const a=L(k({},d.selectedCompanySettings));y(()=>l.config.retrospective_edits.map(t=>(t.title=g(t.key),t))),R(()=>a.carbon_date_format,t=>{if(t){const n=l.dateFormats.find(c=>c.carbon_format_value===t);a.moment_date_format=n.moment_format_value}});const S=y({get:()=>a.discount_per_item==="YES",set:async t=>{const n=t?"YES":"NO";let c={settings:{discount_per_item:n}};a.discount_per_item=n,await d.updateCompanySettings({data:c,message:"general.setting_updated"})}}),V=y({get:()=>a.automatically_expire_public_links==="YES",set:async t=>{const n=t?"YES":"NO";a.automatically_expire_public_links=n}}),E=y(()=>({currency:{required:f.withMessage(g("validation.required"),b)},language:{required:f.withMessage(g("validation.required"),b)},carbon_date_format:{required:f.withMessage(g("validation.required"),b)},moment_date_format:{required:f.withMessage(g("validation.required"),b)},time_zone:{required:f.withMessage(g("validation.required"),b)},fiscal_year:{required:f.withMessage(g("validation.required"),b)}})),o=ae(E,y(()=>a));G();async function G(){i.value=!0,Promise.all([l.fetchCurrencies(),l.fetchDateFormats(),l.fetchTimeZones()]).then(([t])=>{i.value=!1})}async function O(){if(o.value.$touch(),o.value.$invalid)return;let t={settings:k({},a)};v.value=!0,delete t.settings.link_expiry_days,await d.updateCompanySettings({data:t,message:"settings.preferences.updated_message"}),v.value=!1}async function P(){$.value=!0,await d.updateCompanySettings({data:{settings:{link_expiry_days:a.link_expiry_days,automatically_expire_public_links:a.automatically_expire_public_links}},message:"settings.preferences.updated_message"}),$.value=!1}return(t,n)=>{const c=m("BaseMultiselect"),_=m("BaseInputGroup"),Y=m("BaseInputGrid"),w=m("BaseIcon"),q=m("BaseButton"),I=m("BaseDivider"),C=m("BaseSwitchSection"),T=m("BaseInput"),Z=m("BaseSettingCard");return z(),H("form",{action:"",class:"relative",onSubmit:j(O,["prevent"])},[s(Z,{title:t.$t("settings.menu_title.preferences"),description:t.$t("settings.preferences.general_settings")},{default:u(()=>[s(Y,{class:"mt-5"},{default:u(()=>[s(_,{"content-loading":e(i),label:t.$tc("settings.preferences.currency"),"help-text":t.$t("settings.preferences.company_currency_unchangeable"),error:e(o).currency.$error&&e(o).currency.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(a).currency,"onUpdate:modelValue":n[0]||(n[0]=r=>e(a).currency=r),"content-loading":e(i),options:e(l).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",invalid:e(o).currency.$error,disabled:"",class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","label","help-text","error"]),s(_,{label:t.$tc("settings.preferences.default_language"),"content-loading":e(i),error:e(o).language.$error&&e(o).language.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(a).language,"onUpdate:modelValue":n[1]||(n[1]=r=>e(a).language=r),"content-loading":e(i),options:e(l).config.languages,label:"name","value-prop":"code",class:"w-full","track-by":"name",searchable:!0,invalid:e(o).language.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(_,{label:t.$tc("settings.preferences.time_zone"),"content-loading":e(i),error:e(o).time_zone.$error&&e(o).time_zone.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(a).time_zone,"onUpdate:modelValue":n[2]||(n[2]=r=>e(a).time_zone=r),"content-loading":e(i),options:e(l).timeZones,label:"key","value-prop":"value","track-by":"key",searchable:!0,invalid:e(o).time_zone.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(_,{label:t.$tc("settings.preferences.date_format"),"content-loading":e(i),error:e(o).carbon_date_format.$error&&e(o).carbon_date_format.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(a).carbon_date_format,"onUpdate:modelValue":n[3]||(n[3]=r=>e(a).carbon_date_format=r),"content-loading":e(i),options:e(l).dateFormats,label:"display_date","value-prop":"carbon_format_value","track-by":"display_date",searchable:"",invalid:e(o).carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(_,{"content-loading":e(i),error:e(o).fiscal_year.$error&&e(o).fiscal_year.$errors[0].$message,label:t.$tc("settings.preferences.fiscal_year"),required:""},{default:u(()=>[s(c,{modelValue:e(a).fiscal_year,"onUpdate:modelValue":n[4]||(n[4]=r=>e(a).fiscal_year=r),"content-loading":e(i),options:e(l).config.fiscal_years,label:"key","value-prop":"value",invalid:e(o).fiscal_year.$error,"track-by":"key",searchable:!0,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","error","label"])]),_:1}),s(q,{"content-loading":e(i),disabled:e(v),loading:e(v),type:"submit",class:"mt-6"},{left:u(r=>[s(w,{name:"SaveIcon",class:D(r.class)},null,8,["class"])]),default:u(()=>[F(" "+N(t.$tc("settings.company_info.save")),1)]),_:1},8,["content-loading","disabled","loading"]),s(I,{class:"mt-6 mb-2"}),U("ul",null,[U("form",{onSubmit:j(P,["prevent"])},[s(C,{modelValue:e(V),"onUpdate:modelValue":n[5]||(n[5]=r=>x(V)?V.value=r:null),title:t.$t("settings.preferences.expire_public_links"),description:t.$t("settings.preferences.expire_setting_description")},null,8,["modelValue","title","description"]),e(V)?(z(),Q(_,{key:0,"content-loading":e(i),label:t.$t("settings.preferences.expire_public_links"),class:"mt-2 mb-4"},{default:u(()=>[s(T,{modelValue:e(a).link_expiry_days,"onUpdate:modelValue":n[6]||(n[6]=r=>e(a).link_expiry_days=r),disabled:e(a).automatically_expire_public_links==="NO","content-loading":e(i),type:"number"},null,8,["modelValue","disabled","content-loading"])]),_:1},8,["content-loading","label"])):W("",!0),s(q,{"content-loading":e(i),disabled:e($),loading:e($),type:"submit",class:"mt-6"},{left:u(r=>[s(w,{name:"SaveIcon",class:D(r.class)},null,8,["class"])]),default:u(()=>[F(" "+N(t.$tc("general.save")),1)]),_:1},8,["content-loading","disabled","loading"])],40,le),s(I,{class:"mt-6 mb-2"}),s(C,{modelValue:e(S),"onUpdate:modelValue":n[7]||(n[7]=r=>x(S)?S.value=r:null),title:t.$t("settings.preferences.discount_per_item"),description:t.$t("settings.preferences.discount_setting_description")},null,8,["modelValue","title","description"])])]),_:1},8,["title","description"])],40,ne)}}};export{de as default};
