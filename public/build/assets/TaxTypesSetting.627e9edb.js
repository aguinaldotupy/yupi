import{C as H,u as K,b as Y,U as $,o as q,p as M,k as j,s as x,j as G,V as J}from"./main.9bc4ee1d.js";import{i as z,z as o,A as p,O as g,K as t,u as a,C as n,L as T,M as B,N,e as O,c as P,a2 as V,P as Q,B as W,j as Z}from"./vendor.8df7962f.js";import{_ as ee}from"./TaxTypeModal.616812f0.js";const te={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(S){const s=S,b=H();K();const{t:r}=Y(),C=$(),v=q(),m=M(),E=j();z("utils");async function c(d){await C.fetchTaxType(d),E.openModal({title:r("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:s.loadData&&s.loadData})}function h(d){b.openDialog({title:r("general.are_you_sure"),message:r("settings.tax_types.confirm_delete"),yesLabel:r("general.ok"),noLabel:r("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async u=>{if(u){if((await C.deleteTaxType(d)).data.success)return s.loadData&&s.loadData(),!0;s.loadData&&s.loadData()}})}return(d,u)=>{const i=o("BaseIcon"),w=o("BaseButton"),D=o("BaseDropdownItem"),k=o("BaseDropdown");return p(),g(k,null,{activator:t(()=>[a(v).name==="tax-types.view"?(p(),g(w,{key:0,variant:"primary"},{default:t(()=>[n(i,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(p(),g(i,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:t(()=>[a(m).hasAbilities(a(x).EDIT_TAX_TYPE)?(p(),g(D,{key:0,onClick:u[0]||(u[0]=I=>c(S.row.id))},{default:t(()=>[n(i,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(d.$t("general.edit")),1)]),_:1})):N("",!0),a(m).hasAbilities(a(x).DELETE_TAX_TYPE)?(p(),g(D,{key:1,onClick:u[1]||(u[1]=I=>h(S.row.id))},{default:t(()=>[n(i,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(d.$t("general.delete")),1)]),_:1})):N("",!0)]),_:1})}}},ae={key:0},le={setup(S){const{t:s}=Y(),b=z("utils"),r=G(),C=$(),v=j(),m=M(),E=J(),c=O(null),h=O(r.selectedCompanySettings.tax_per_item),d=P(()=>[{key:"name",label:s("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"compound_tax",label:s("settings.tax_types.compound_tax"),tdClass:"font-medium text-gray-900"},{key:"percent",label:s("settings.tax_types.percent"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),u=P(()=>r.selectedCompanySettings.sales_tax_us_enabled==="YES"&&E.salesTaxUSEnabled),i=P({get:()=>h.value==="YES",set:async l=>{const _=l?"YES":"NO";let y={settings:{tax_per_item:_}};h.value=_,await r.updateCompanySettings({data:y,message:"general.setting_updated"})}});function w(){return m.hasAbilities([x.DELETE_TAX_TYPE,x.EDIT_TAX_TYPE])}async function D({page:l,filter:_,sort:y}){let A={orderByField:y.fieldName||"created_at",orderBy:y.order||"desc",page:l},f=await C.fetchTaxTypes(A);return{data:f.data.data,pagination:{totalPages:f.data.meta.last_page,currentPage:l,totalCount:f.data.meta.total,limit:5}}}async function k(){c.value&&c.value.refresh()}function I(){v.openModal({title:s("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:c.value&&c.value.refresh})}return(l,_)=>{const y=o("BaseIcon"),A=o("BaseButton"),f=o("BaseBadge"),L=o("BaseTable"),U=o("BaseDivider"),X=o("BaseSwitchSection"),F=o("BaseSettingCard");return p(),g(F,{title:l.$t("settings.tax_types.title"),description:l.$t("settings.tax_types.description")},V({default:t(()=>[n(ee),n(L,{ref:(e,R)=>{R.table=e,c.value=e},class:"mt-16",data:D,columns:a(d)},V({"cell-compound_tax":t(({row:e})=>[n(f,{"bg-color":a(b).getBadgeStatusColor(e.data.compound_tax?"YES":"NO").bgColor,color:a(b).getBadgeStatusColor(e.data.compound_tax?"YES":"NO").color},{default:t(()=>[T(B(e.data.compound_tax?"Yes":"No".replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),"cell-percent":t(({row:e})=>[T(B(e.data.percent)+" % ",1)]),_:2},[w()?{name:"cell-actions",fn:t(({row:e})=>[n(te,{row:e.data,table:c.value,"load-data":k},null,8,["row","table"])])}:void 0]),1032,["columns"]),a(m).currentUser.is_owner?(p(),W("div",ae,[n(U,{class:"mt-8 mb-2"}),n(X,{modelValue:a(i),"onUpdate:modelValue":_[0]||(_[0]=e=>Z(i)?i.value=e:null),disabled:a(u),title:l.$t("settings.tax_types.tax_per_item"),description:l.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","disabled","title","description"])])):N("",!0)]),_:2},[a(m).hasAbilities(a(x).CREATE_TAX_TYPE)?{name:"action",fn:t(()=>[n(A,{type:"submit",variant:"primary-outline",onClick:I},{left:t(e=>[n(y,{class:Q(e.class),name:"PlusIcon"},null,8,["class"])]),default:t(()=>[T(" "+B(l.$t("settings.tax_types.add_new_tax")),1)]),_:1})])}:void 0]),1032,["title","description"])}}};export{le as default};
