import{i as Q,e as y,r as Y,c as I,z as o,A as c,O as d,K as a,C as t,u as l,P as C,L as _,M as p,N as w,R as S,ad as F,J as P}from"./vendor.8df7962f.js";import Z from"./BaseTable.bca5802d.js";import{u as ee}from"./global.f0bfa203.js";import{u as te}from"./estimate.4e6a4908.js";import{b as ae,o as se,G as oe}from"./main.9bc4ee1d.js";import{_ as le}from"./ObservatoryIcon.589c28ec.js";import"./auth.803a091d.js";const ne=P("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1),re={class:"relative table-container"},be={setup(me){const{t:f}=ae();Q("utils"),se();const E=y(null);let u=y(!1),h=y(!0);const x=y(["DRAFT","SENT","VIEWED","EXPIRED","ACCEPTED","REJECTED"]),s=Y({status:"",from_date:"",to_date:"",estimate_number:""}),v=ee(),b=te(),j=I(()=>[{key:"estimate_date",label:f("estimates.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"estimate_number",label:f("estimates.number",2)},{key:"status",label:f("estimates.status")},{key:"total",label:f("estimates.total")},{key:"actions",thClass:"text-right",tdClass:"text-right text-sm font-medium",sortable:!1}]),k=I(()=>!b.totalEstimates&&!h.value);I(()=>v.currency),oe(s,()=>{T()},{debounce:500});function N(){E.value.refresh()}function T(){N()}function D(){s.status="",s.from_date="",s.to_date="",s.estimate_number=""}function H(){u.value&&D(),u.value=!u.value}async function R({page:n,sort:r}){let B={status:s.status,estimate_number:s.estimate_number,from_date:s.from_date,to_date:s.to_date,orderByField:r.fieldName||"created_at",orderBy:r.order||"desc",page:n};h.value=!0;let i=await b.fetchEstimate(B,v.companySlug);return h.value=!1,{data:i.data.data,pagination:{totalPages:i.data.meta.last_page,currentPage:n,totalCount:i.data.meta.total,limit:10}}}return(n,r)=>{const B=o("BaseBreadcrumbItem"),i=o("BaseBreadcrumb"),m=o("BaseIcon"),z=o("BaseButton"),G=o("BasePageHeader"),U=o("BaseSelectInput"),g=o("BaseInputGroup"),W=o("BaseInput"),V=o("BaseDatePicker"),A=o("BaseFilterWrapper"),M=o("BaseEmptyPlaceholder"),$=o("router-link"),J=o("BaseEstimateStatusBadge"),O=o("BaseFormatMoney"),X=o("BaseDropdownItem"),K=o("BaseDropdown"),L=o("BasePage");return c(),d(L,null,{default:a(()=>[t(G,{title:n.$t("estimates.title")},{actions:a(()=>[l(b).totalEstimates?(c(),d(z,{key:0,variant:"primary-outline",onClick:H},{right:a(e=>[l(u)?(c(),d(m,{key:1,name:"XIcon",class:C(e.class)},null,8,["class"])):(c(),d(m,{key:0,name:"FilterIcon",class:C(e.class)},null,8,["class"]))]),default:a(()=>[_(p(n.$t("general.filter"))+" ",1)]),_:1})):w("",!0)]),default:a(()=>[t(i,null,{default:a(()=>[t(B,{title:n.$t("general.home"),to:`/${l(v).companySlug}/customer/dashboard`},null,8,["title","to"]),t(B,{title:n.$tc("estimates.estimate",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),S(t(A,{onClear:D},{default:a(()=>[t(g,{label:n.$t("estimates.status"),class:"px-3"},{default:a(()=>[t(U,{modelValue:l(s).status,"onUpdate:modelValue":r[0]||(r[0]=e=>l(s).status=e),options:x.value,searchable:"","show-labels":!1,"allow-empty":!1,placeholder:n.$t("general.select_a_status")},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),t(g,{label:n.$t("estimates.estimate_number"),color:"black-light",class:"px-3 mt-2"},{default:a(()=>[t(W,{modelValue:l(s).estimate_number,"onUpdate:modelValue":r[1]||(r[1]=e=>l(s).estimate_number=e)},{default:a(()=>[t(m,{name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}),t(m,{name:"HashtagIcon",class:"h-5 mr-3 text-gray-600"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(g,{label:n.$t("general.from"),class:"px-3"},{default:a(()=>[t(V,{modelValue:l(s).from_date,"onUpdate:modelValue":r[2]||(r[2]=e=>l(s).from_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),ne,t(g,{label:n.$t("general.to"),class:"px-3"},{default:a(()=>[t(V,{modelValue:l(s).to_date,"onUpdate:modelValue":r[3]||(r[3]=e=>l(s).to_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},512),[[F,l(u)]]),l(k)?(c(),d(M,{key:0,title:n.$t("estimates.no_estimates"),description:n.$t("estimates.list_of_estimates")},{default:a(()=>[t(le,{class:"mt-5 mb-4"})]),_:1},8,["title","description"])):w("",!0),S(P("div",re,[t(Z,{ref:(e,q)=>{q.table=e,E.value=e},data:R,columns:l(j),"placeholder-count":l(b).totalEstimates>=20?10:5,class:"mt-10"},{"cell-estimate_date":a(({row:e})=>[_(p(e.data.formatted_estimate_date),1)]),"cell-estimate_number":a(({row:e})=>[t($,{to:{path:`estimates/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:a(()=>[_(p(e.data.estimate_number),1)]),_:2},1032,["to"])]),"cell-status":a(({row:e})=>[t(J,{status:e.data.status,class:"px-3 py-1"},{default:a(()=>[_(p(e.data.status),1)]),_:2},1032,["status"])]),"cell-total":a(({row:e})=>[t(O,{amount:e.data.total},null,8,["amount"])]),"cell-actions":a(({row:e})=>[t(K,null,{activator:a(()=>[t(m,{name:"DotsHorizontalIcon",class:"h-5 text-gray-500"})]),default:a(()=>[t($,{to:`estimates/${e.data.id}/view`},{default:a(()=>[t(X,null,{default:a(()=>[t(m,{name:"EyeIcon",class:"h-5 mr-3 text-gray-600"}),_(" "+p(n.$t("general.view")),1)]),_:1})]),_:2},1032,["to"])]),_:2},1024)]),_:1},8,["columns","placeholder-count"])],512),[[F,!l(k)]])]),_:1})}}};export{be as default};
